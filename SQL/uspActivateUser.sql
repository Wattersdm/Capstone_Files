USE PlanIt
GO

DROP PROCEDURE IF EXISTS uspActivateUser
GO

CREATE PROCEDURE uspActivateUser
	@UserID AS INT
AS

SET NOCOUNT ON
SET XACT_ABORT ON

BEGIN TRANSACTION

	UPDATE Users SET Active = 1
	OUTPUT INSERTED.*
	WHERE UserID = @UserID
	AND Active <> 1

COMMIT TRANSACTION
GO